<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" th:href="@{/css/investor_list.css}">
    <title>Cập nhật nhân viên</title>
</head>
<body>
<div>
    <div class="toolbar">
        <a href="#" onclick="showSubform('add')">Thêm</a>
        <a th:href="@{/nhanvien}">Thoát</a>
    </div>

    <table class="main-table">
        <thead>
            <tr>
                <th>Mã</th>
                <th>Họ tên</th>
                <th>Ngày sinh</th>
                <th>Địa chỉ</th>
                <th>Số điện thoại</th>
                <th>CMND</th>
                <th>Giới tính</th>
                <th>Email</th>
            </tr>
        </thead>
        <tbody>
            <tr th:if="${#lists.isEmpty(employees)}">
                <td colspan="9" style="text-align: center;" th:text="${noDataMessage}"></td>
            </tr>
            <tr th:each="employee : ${employees}">
                <td th:text="${employee.maNV}"></td>
                <td th:text="${employee.hoTen}"></td>
                <td th:text="${employee.ngaySinh}"></td>
                <td th:text="${employee.diaChi}"></td>
                <td th:text="${employee.phone}"></td>
                <td th:text="${employee.cmnd}"></td>
                <td th:text="${employee.gioiTinh}"></td>
                <td th:text="${employee.email}"></td>
            </tr>
        </tbody>
    </table>

    <div id="subform" class="subform-container">
        <h3 id="subform-title"></h3>
        <form id="employee-form" th:action="@{/employees/add}" th:object="${employee}" method="post">
            <table class="subform-table">
                <tr id="row-maNV">
                    <td><label>Mã nhân viên:</label></td>
                    <td><input type="text" th:field="*{maNV}" id="maNV" maxlength="20" required /></td>
                </tr>
                <tr>
                    <td><label>Họ tên:</label></td>
                    <td><input type="text" th:field="*{hoTen}" maxlength="50" required /></td>
                </tr>
                <tr>
                    <td><label>Ngày sinh:</label></td>
                    <td><input type="date" th:field="*{ngaySinh}" required /></td>
                </tr>
                <tr>
                    <td><label>Địa chỉ:</label></td>
                    <td><input type="text" th:field="*{diaChi}" maxlength="100" required /></td>
                </tr>
                <tr>
                    <td><label>Số điện thoại:</label></td>
                    <td><input type="text" th:field="*{phone}" maxlength="15" required /></td>
                </tr>
                <tr>
                    <td><label>CMND:</label></td>
                    <td><input type="text" th:field="*{cmnd}" id="cmnd" maxlength="10" required /></td>
                </tr>
                <tr>
                    <td><label>Giới tính:</label></td>
                    <td>
                        <input type="radio" th:field="*{gioiTinh}" value="Nam" id="nam" />
                        <label for="nam">Nam</label>
                        <input type="radio" th:field="*{gioiTinh}" value="Nữ" id="nu" style="margin-left: 20px;" />
                        <label for="nu">Nữ</label>
                    </td>
                </tr>
                <tr>
                    <td><label>Email:</label></td>
                    <td><input type="email" th:field="*{email}" maxlength="50" required /></td>
                </tr>
            </table>

            <div class="form-actions">
                <button type="submit">Lưu</button>
                <button type="button" onclick="hideSubform()">Hủy</button>
            </div>
        </form>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        console.log("Trang đã tải xong, sẵn sàng xử lý sự kiện.");

        document.getElementById("employee-form").addEventListener("submit", function(e) {
            const maNV = document.getElementById("maNV").value;
            const cmnd = document.getElementById("cmnd").value;
            console.log("Biểu mẫu được gửi, Mã NV (input):", maNV);
            console.log("Biểu mẫu được gửi, CMND (input):", cmnd);
            console.log("Action của form:", this.action);
        });
    });

    function showSubform(action, maNV = '') {
        const subform = document.getElementById('subform');
        const title = document.getElementById('subform-title');
        const form = document.getElementById('employee-form');
        const maNVInput = document.getElementById('maNV');
        const rowMaNV = document.getElementById('row-maNV');

        subform.classList.add('active');
        form.reset();

        if (action === 'add') {
            title.textContent = 'Thêm nhân viên';
            form.action = '/employees/add';
            maNVInput.disabled = true;
            maNVInput.value = '';
            rowMaNV.style.display = 'none'; // Ẩn dòng mã nhân viên
        }
        // Nếu cần mở cho 'edit', bạn có thể thêm else if sau này
    }

    function hideSubform() {
        const subform = document.getElementById('subform');
        subform.classList.remove('active');
    }
</script>
</body>
</html>
